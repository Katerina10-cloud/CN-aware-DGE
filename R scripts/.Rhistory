"TCGA-55-6975-01A-11D-1943-01", "TCGA-49-6743-01A-11D-1854-01",
"TCGA-49-4512-01A-21D-1854-01", "TCGA-55-6972-01A-11D-1943-01",
"TCGA-38-4627-01A-01D-1204-01", "TCGA-44-3398-01A-01D-1549-01",
"TCGA-44-2655-01A-01D-0944-01", "TCGA-44-6146-01A-11D-1752-01",
"TCGA-44-2661-01A-01D-1549-01", "TCGA-49-6745-01A-11D-1854-01"))
##build a query to retrieve Copy Number data
query_TCGA <- GDCquery(project = 'TCGA-LUAD',
data.category = 'Copy Number Variation',
sample.type = c("Primary Tumor"),
data.type = "Gene Level Copy Number",
workflow.type = 'ASCAT3',
barcode = c("TCGA-50-5932-01A-11D-1752-01", "TCGA-49-6742-01A-11D-1854-01",
"TCGA-44-6147-01A-11D-A273-01", "TCGA-55-6979-01A-11D-1943-01",
"TCGA-50-5931-01A-11D-1752-01", "TCGA-38-4626-01A-01D-1549-01",
"TCGA-91-6835-01A-11D-1854-01", "TCGA-49-4490-01A-21D-1854-01",
"TCGA-55-6970-01A-11D-1943-01", "TCGA-55-6969-01A-11D-1943-01",
"TCGA-91-6831-01A-11D-1854-01", "TCGA-50-5936-01A-11D-1624-01",
"TCGA-44-2665-01A-01D-0944-01", "TCGA-44-6776-01A-11D-1854-01",
"TCGA-55-6978-01A-11D-1943-01", "TCGA-49-6744-01A-11D-1854-01",
"TCGA-55-6982-01A-11D-1943-01", "TCGA-44-3396-01A-01D-1204-01",
"TCGA-49-6761-01A-31D-1943-01", "TCGA-44-6778-01A-11D-1854-01",
"TCGA-44-6145-01A-11D-1752-01", "TCGA-50-6595-01A-12D-1854-01",
"TCGA-44-6148-01A-11D-1752-01", "TCGA-91-6828-01A-11D-1854-01",
"TCGA-91-6849-01A-11D-1943-01", "TCGA-91-6847-01A-11D-1943-01",
"TCGA-44-2668-01A-01D-0944-01", "TCGA-44-2662-01A-01D-0944-01",
"TCGA-44-5645-01A-01D-1624-01", "TCGA-55-6985-01A-11D-1943-01",
"TCGA-44-2657-01A-01D-1549-01", "TCGA-73-4676-01A-01D-1752-01",
"TCGA-50-5939-01A-11D-1624-01", "TCGA-50-5935-01A-11D-1752-01",
"TCGA-55-6981-01A-11D-1943-01", "TCGA-91-6829-01A-21D-1854-01",
"TCGA-44-6777-01A-11D-1854-01", "TCGA-55-6983-01A-11D-1943-01",
"TCGA-91-6836-01A-21D-1854-01", "TCGA-55-6986-01A-11D-1943-01",
"TCGA-38-4625-01A-01D-1204-01", "TCGA-50-5933-01A-11D-1752-01",
"TCGA-38-4632-01A-01D-1752-01", "TCGA-55-6971-01A-11D-1943-01",
"TCGA-55-6975-01A-11D-1943-01", "TCGA-49-6743-01A-11D-1854-01",
"TCGA-49-4512-01A-21D-1854-01", "TCGA-55-6972-01A-11D-1943-01",
"TCGA-38-4627-01A-01D-1204-01", "TCGA-44-3398-01A-01D-1549-01",
"TCGA-44-2655-01A-01D-0944-01", "TCGA-44-6146-01A-11D-1752-01",
"TCGA-44-2661-01A-01D-1549-01", "TCGA-49-6745-01A-11D-1854-01"))
##build a query to retrieve Copy Number data
query_TCGA <- GDCquery(project = 'TCGA-LUAD',
data.category = 'Copy Number Variation',
sample.type = "Primary Tumor",
data.type = "Gene Level Copy Number",
workflow.type = 'ASCAT3',
barcode = c("TCGA-50-5932-01A-11D-1752-01", "TCGA-49-6742-01A-11D-1854-01",
"TCGA-44-6147-01A-11D-A273-01", "TCGA-55-6979-01A-11D-1943-01",
"TCGA-50-5931-01A-11D-1752-01", "TCGA-38-4626-01A-01D-1549-01",
"TCGA-91-6835-01A-11D-1854-01", "TCGA-49-4490-01A-21D-1854-01",
"TCGA-55-6970-01A-11D-1943-01", "TCGA-55-6969-01A-11D-1943-01",
"TCGA-91-6831-01A-11D-1854-01", "TCGA-50-5936-01A-11D-1624-01",
"TCGA-44-2665-01A-01D-0944-01", "TCGA-44-6776-01A-11D-1854-01",
"TCGA-55-6978-01A-11D-1943-01", "TCGA-49-6744-01A-11D-1854-01",
"TCGA-55-6982-01A-11D-1943-01", "TCGA-44-3396-01A-01D-1204-01",
"TCGA-49-6761-01A-31D-1943-01", "TCGA-44-6778-01A-11D-1854-01",
"TCGA-44-6145-01A-11D-1752-01", "TCGA-50-6595-01A-12D-1854-01",
"TCGA-44-6148-01A-11D-1752-01", "TCGA-91-6828-01A-11D-1854-01",
"TCGA-91-6849-01A-11D-1943-01", "TCGA-91-6847-01A-11D-1943-01",
"TCGA-44-2668-01A-01D-0944-01", "TCGA-44-2662-01A-01D-0944-01",
"TCGA-44-5645-01A-01D-1624-01", "TCGA-55-6985-01A-11D-1943-01",
"TCGA-44-2657-01A-01D-1549-01", "TCGA-73-4676-01A-01D-1752-01",
"TCGA-50-5939-01A-11D-1624-01", "TCGA-50-5935-01A-11D-1752-01",
"TCGA-55-6981-01A-11D-1943-01", "TCGA-91-6829-01A-21D-1854-01",
"TCGA-44-6777-01A-11D-1854-01", "TCGA-55-6983-01A-11D-1943-01",
"TCGA-91-6836-01A-21D-1854-01", "TCGA-55-6986-01A-11D-1943-01",
"TCGA-38-4625-01A-01D-1204-01", "TCGA-50-5933-01A-11D-1752-01",
"TCGA-38-4632-01A-01D-1752-01", "TCGA-55-6971-01A-11D-1943-01",
"TCGA-55-6975-01A-11D-1943-01", "TCGA-49-6743-01A-11D-1854-01",
"TCGA-49-4512-01A-21D-1854-01", "TCGA-55-6972-01A-11D-1943-01",
"TCGA-38-4627-01A-01D-1204-01", "TCGA-44-3398-01A-01D-1549-01",
"TCGA-44-2655-01A-01D-0944-01", "TCGA-44-6146-01A-11D-1752-01",
"TCGA-44-2661-01A-01D-1549-01", "TCGA-49-6745-01A-11D-1854-01"))
##build a query to retrieve Copy Number data
query_TCGA <- GDCquery(project = 'TCGA-LUAD',
data.category = 'Copy Number Variation',
#sample.type = "Primary Tumor",
data.type = "Gene Level Copy Number",
workflow.type = 'ASCAT3',
barcode = c("TCGA-50-5932-01A-11D-1752-01", "TCGA-49-6742-01A-11D-1854-01",
"TCGA-44-6147-01A-11D-A273-01", "TCGA-55-6979-01A-11D-1943-01",
"TCGA-50-5931-01A-11D-1752-01", "TCGA-38-4626-01A-01D-1549-01",
"TCGA-91-6835-01A-11D-1854-01", "TCGA-49-4490-01A-21D-1854-01",
"TCGA-55-6970-01A-11D-1943-01", "TCGA-55-6969-01A-11D-1943-01",
"TCGA-91-6831-01A-11D-1854-01", "TCGA-50-5936-01A-11D-1624-01",
"TCGA-44-2665-01A-01D-0944-01", "TCGA-44-6776-01A-11D-1854-01",
"TCGA-55-6978-01A-11D-1943-01", "TCGA-49-6744-01A-11D-1854-01",
"TCGA-55-6982-01A-11D-1943-01", "TCGA-44-3396-01A-01D-1204-01",
"TCGA-49-6761-01A-31D-1943-01", "TCGA-44-6778-01A-11D-1854-01",
"TCGA-44-6145-01A-11D-1752-01", "TCGA-50-6595-01A-12D-1854-01",
"TCGA-44-6148-01A-11D-1752-01", "TCGA-91-6828-01A-11D-1854-01",
"TCGA-91-6849-01A-11D-1943-01", "TCGA-91-6847-01A-11D-1943-01",
"TCGA-44-2668-01A-01D-0944-01", "TCGA-44-2662-01A-01D-0944-01",
"TCGA-44-5645-01A-01D-1624-01", "TCGA-55-6985-01A-11D-1943-01",
"TCGA-44-2657-01A-01D-1549-01", "TCGA-73-4676-01A-01D-1752-01",
"TCGA-50-5939-01A-11D-1624-01", "TCGA-50-5935-01A-11D-1752-01",
"TCGA-55-6981-01A-11D-1943-01", "TCGA-91-6829-01A-21D-1854-01",
"TCGA-44-6777-01A-11D-1854-01", "TCGA-55-6983-01A-11D-1943-01",
"TCGA-91-6836-01A-21D-1854-01", "TCGA-55-6986-01A-11D-1943-01",
"TCGA-38-4625-01A-01D-1204-01", "TCGA-50-5933-01A-11D-1752-01",
"TCGA-38-4632-01A-01D-1752-01", "TCGA-55-6971-01A-11D-1943-01",
"TCGA-55-6975-01A-11D-1943-01", "TCGA-49-6743-01A-11D-1854-01",
"TCGA-49-4512-01A-21D-1854-01", "TCGA-55-6972-01A-11D-1943-01",
"TCGA-38-4627-01A-01D-1204-01", "TCGA-44-3398-01A-01D-1549-01",
"TCGA-44-2655-01A-01D-0944-01", "TCGA-44-6146-01A-11D-1752-01",
"TCGA-44-2661-01A-01D-1549-01", "TCGA-49-6745-01A-11D-1854-01"))
View(query_TCGA)
View(query_TCGA[[1]][[1]])
#download
GDCdownload(query_TCGA)
#prepare data
tcga_luad_cnv <- GDCprepare(query_TCGA, summarizedExperiment = TRUE)
luad_cnv_tumor <- assay(tcga_luad_cnv, 'copy_number', rownames = TRUE)
View(luad_cnv_tumor)
View(luad_cnv_tumor)
gene_name <- as.data.frame(tcga_luad_cnv@rowRanges@elementMetadata@listData[["gene_name"]])
View(gene_name)
colnames(gene_name)[1] <- "GeneID"
luad_cnv_tumor <- as.data.frame(luad_rna_tumor)
luad_cnv_tumor <- as.data.frame(luad_cnv_tumor)
View(luad_cnv_tumor)
luad_cnv_tumor <- cbind(gene_name, luad_cnv_tumor)
luad_cnv_tumor <- luad_cnv_tumor[!duplicated(luad_cnv_tumor$GeneID), ]
View(luad_cnv_tumor)
luad_cnv_tumor <- luad_cnv_tumor %>% remove_rownames %>% column_to_rownames(var="GeneID")
View(luad_cnv_tumor)
luad_cnv_tumor %>% na.rm
luad_cnv_tumor <- as.data.frame(luad_cnv_tumor, na.rm = TRUE)
View(luad_cnv_tumor)
luand_cnv_tumor <- na.omit(luand_cnv_tumor)
luad_cnv_tumor <- na.omit(luad_cnv_tumor)
View(luad_cnv_tumor)
save(luad_cnv_tumor, file = "~/model_data/TCGA/lung_cancer/luad_cnv_tumor.Rdata")
query_TCGA_tumor <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Transcriptome Profiling',
experimental.strategy = 'RNA-Seq',
workflow.type = 'STAR - Counts',
data.type = "Gene Expression Quantification",
access = 'open',
sample.type = "Primary Tumor",
barcode = c("TCGA-E9-A1RH-01A-21R-A169-07", "TCGA-BH-A1ET-01A-11R-A137-07",
"TCGA-BH-A0HK-01A-11R-A056-07", "TCGA-BH-A0H5-01A-21R-A115-07",
"TCGA-AC-A2FM-01A-11R-A19W-07", "TCGA-BH-A0DK-01A-21R-A056-07",
"TCGA-BH-A1FC-01A-11R-A13Q-07", "TCGA-E9-A1N9-01A-11R-A14D-07",
"TCGA-GI-A2C8-01A-11R-A16F-07", "TCGA-BH-A18L-01A-32R-A12D-07",
"TCGA-BH-A0BS-01A-11R-A12P-07", "TCGA-BH-A0BQ-01A-21R-A115-07",
"TCGA-BH-A209-01A-11R-A157-07", "TCGA-BH-A1EV-01A-11R-A137-07",
"TCGA-BH-A1FR-01A-11R-A13Q-07", "TCGA-BH-A0BC-01A-22R-A084-07",
"TCGA-BH-A0BA-01A-11R-A056-07", "TCGA-BH-A18J-01A-11R-A12D-07",
"TCGA-BH-A203-01A-12R-A169-07", "TCGA-BH-A18M-01A-11R-A12D-07",
"TCGA-BH-A1FJ-01A-11R-A13Q-07", "TCGA-BH-A18R-01A-11R-A12D-07",
"TCGA-E9-A1ND-01A-11R-A144-07", "TCGA-A7-A0DB-01A-11R-A00Z-07",
"TCGA-E2-A158-01A-11R-A12D-07", "TCGA-BH-A1FU-01A-11R-A14D-07",
"TCGA-E9-A1RF-01A-11R-A157-07", "TCGA-E9-A1N5-01A-11R-A14D-07",
"TCGA-E2-A1L7-01A-11R-A144-07", "TCGA-E2-A1IG-01A-11R-A144-07",
"TCGA-AC-A2FF-01A-11R-A17B-07", "TCGA-BH-A1FE-01A-11R-A13Q-07",
"TCGA-BH-A0DT-01A-21R-A12D-07", "TCGA-BH-A1EW-01A-11R-A137-07",
"TCGA-A7-A0CE-01A-11R-A00Z-07", "TCGA-BH-A1F2-01A-31R-A13Q-07",
"TCGA-A7-A13G-01A-11R-A13Q-07", "TCGA-BH-A18V-01A-11R-A12D-07",
"TCGA-AC-A2FB-01A-11R-A17B-07", "TCGA-A7-A13F-01A-11R-A12P-07",
"TCGA-BH-A0E0-01A-11R-A056-07", "TCGA-BH-A1F0-01A-11R-A137-07",
"TCGA-BH-A0B3-01A-11R-A056-07", "TCGA-BH-A1EU-01A-11R-A137-07",
"TCGA-BH-A0DD-01A-31R-A12P-07", "TCGA-AC-A23H-01A-11R-A157-07",
"TCGA-BH-A0AY-01A-21R-A00Z-07", "TCGA-E9-A1RB-01A-11R-A157-07",
"TCGA-E9-A1NA-01A-11R-A144-07", "TCGA-BH-A1FD-01A-11R-A13Q-07",
"TCGA-BH-A0BM-01A-11R-A056-07", "TCGA-BH-A1F8-01A-11R-A13Q-07",
"TCGA-E9-A1RI-01A-11R-A169-07", "TCGA-BH-A1F6-01A-11R-A13Q-07",
"TCGA-E9-A1N6-01A-11R-A144-07", "TCGA-A7-A0CH-01A-21R-A00Z-07",
"TCGA-BH-A0H7-01A-13R-A056-07", "TCGA-BH-A18U-01A-21R-A12D-07",
"TCGA-BH-A18U-01A-21R-A12D-07", "TCGA-E2-A1BC-01A-11R-A12P-07",
"TCGA-BH-A1FN-01A-11R-A13Q-07", "TCGA-BH-A1FM-01A-11R-A13Q-07",
"TCGA-E2-A15M-01A-11R-A12D-07", "TCGA-BH-A0DH-01A-11R-A084-07",
"TCGA-BH-A0AU-01A-11R-A12P-07", "TCGA-E9-A1RD-01A-11R-A157-07",
"TCGA-BH-A0C0-01A-21R-A056-07", "TCGA-BH-A0HA-01A-11R-A12P-07",
"TCGA-BH-A0BZ-01A-31R-A12P-07", "TCGA-BH-A0BW-01A-11R-A115-07",
"TCGA-BH-A1EN-01A-11R-A13Q-07", "TCGA-BH-A1FB-01A-11R-A13Q-07",
"TCGA-E9-A1NF-01A-11R-A14D-07", "TCGA-BH-A0H9-01A-11R-A056-07",
"TCGA-BH-A0DP-01A-21R-A056-07", "TCGA-A7-A0DC-01A-11R-A00Z-07",
"TCGA-E2-A1LB-01A-11R-A144-07", "TCGA-E2-A15I-01A-21R-A137-07",
"TCGA-BH-A0BV-01A-11R-A00Z-07", "TCGA-BH-A18N-01A-11R-A12D-07",
"TCGA-E9-A1N4-01A-11R-A14M-07", "TCGA-BH-A0DQ-01A-11R-A084-07",
"TCGA-BH-A0BT-01A-11R-A12P-07", "TCGA-BH-A0B7-01A-12R-A115-07",
"TCGA-BH-A18K-01A-11R-A12D-07", "TCGA-A7-A0D9-01A-31R-A056-07",
"TCGA-E9-A1NG-01A-21R-A14M-07", "TCGA-BH-A0DO-01B-11R-A12D-07",
"TCGA-BH-A0B8-01A-21R-A056-07", "TCGA-BH-A1FG-01A-11R-A13Q-07",
"TCGA-BH-A18Q-01A-12R-A12D-07", "TCGA-E9-A1R7-01A-11R-A14M-07",
"TCGA-BH-A0DG-01A-21R-A12P-07", "TCGA-BH-A208-01A-11R-A157-07",
"TCGA-BH-A0DL-01A-11R-A115-07", "TCGA-BH-A0C3-01A-21R-A12P-07",
"TCGA-A7-A13E-01A-11R-A277-07", "TCGA-BH-A0E1-01A-11R-A056-07",
"TCGA-BH-A0B5-01A-11R-A12P-07", "TCGA-BH-A204-01A-11R-A157-07",
"TCGA-BH-A0AZ-01A-21R-A12P-07", "TCGA-E2-A15K-01A-11R-A12P-07",
"TCGA-BH-A1FH-01A-12R-A13Q-07", "TCGA-BH-A18P-01A-11R-A12D-07",
"TCGA-BH-A0BJ-01A-11R-A056-07", "TCGA-E2-A1LH-01A-11R-A14D-07",
"TCGA-E2-A153-01A-12R-A12D-07", "TCGA-BH-A18S-01A-11R-A12D-07",
"TCGA-BH-A1EO-01A-11R-A137-07", "TCGA-E9-A1RC-01A-11R-A157-07",
"TCGA-BH-A0DZ-01A-11R-A00Z-07", "TCGA-E2-A1LS-01A-12R-A157-07",
"TCGA-BH-A0DV-01A-21R-A12P-07")
)
#BiocManager::install("TCGAbiolinks")
library(TCGAbiolinks)
library(tidyverse)
library(SummarizedExperiment)
query_TCGA_tumor <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Transcriptome Profiling',
experimental.strategy = 'RNA-Seq',
workflow.type = 'STAR - Counts',
data.type = "Gene Expression Quantification",
access = 'open',
sample.type = "Primary Tumor",
barcode = c("TCGA-E9-A1RH-01A-21R-A169-07", "TCGA-BH-A1ET-01A-11R-A137-07",
"TCGA-BH-A0HK-01A-11R-A056-07", "TCGA-BH-A0H5-01A-21R-A115-07",
"TCGA-AC-A2FM-01A-11R-A19W-07", "TCGA-BH-A0DK-01A-21R-A056-07",
"TCGA-BH-A1FC-01A-11R-A13Q-07", "TCGA-E9-A1N9-01A-11R-A14D-07",
"TCGA-GI-A2C8-01A-11R-A16F-07", "TCGA-BH-A18L-01A-32R-A12D-07",
"TCGA-BH-A0BS-01A-11R-A12P-07", "TCGA-BH-A0BQ-01A-21R-A115-07",
"TCGA-BH-A209-01A-11R-A157-07", "TCGA-BH-A1EV-01A-11R-A137-07",
"TCGA-BH-A1FR-01A-11R-A13Q-07", "TCGA-BH-A0BC-01A-22R-A084-07",
"TCGA-BH-A0BA-01A-11R-A056-07", "TCGA-BH-A18J-01A-11R-A12D-07",
"TCGA-BH-A203-01A-12R-A169-07", "TCGA-BH-A18M-01A-11R-A12D-07",
"TCGA-BH-A1FJ-01A-11R-A13Q-07", "TCGA-BH-A18R-01A-11R-A12D-07",
"TCGA-E9-A1ND-01A-11R-A144-07", "TCGA-A7-A0DB-01A-11R-A00Z-07",
"TCGA-E2-A158-01A-11R-A12D-07", "TCGA-BH-A1FU-01A-11R-A14D-07",
"TCGA-E9-A1RF-01A-11R-A157-07", "TCGA-E9-A1N5-01A-11R-A14D-07",
"TCGA-E2-A1L7-01A-11R-A144-07", "TCGA-E2-A1IG-01A-11R-A144-07",
"TCGA-AC-A2FF-01A-11R-A17B-07", "TCGA-BH-A1FE-01A-11R-A13Q-07",
"TCGA-BH-A0DT-01A-21R-A12D-07", "TCGA-BH-A1EW-01A-11R-A137-07",
"TCGA-A7-A0CE-01A-11R-A00Z-07", "TCGA-BH-A1F2-01A-31R-A13Q-07",
"TCGA-A7-A13G-01A-11R-A13Q-07", "TCGA-BH-A18V-01A-11R-A12D-07",
"TCGA-AC-A2FB-01A-11R-A17B-07", "TCGA-A7-A13F-01A-11R-A12P-07",
"TCGA-BH-A0E0-01A-11R-A056-07", "TCGA-BH-A1F0-01A-11R-A137-07",
"TCGA-BH-A0B3-01A-11R-A056-07", "TCGA-BH-A1EU-01A-11R-A137-07",
"TCGA-BH-A0DD-01A-31R-A12P-07", "TCGA-AC-A23H-01A-11R-A157-07",
"TCGA-BH-A0AY-01A-21R-A00Z-07", "TCGA-E9-A1RB-01A-11R-A157-07",
"TCGA-E9-A1NA-01A-11R-A144-07", "TCGA-BH-A1FD-01A-11R-A13Q-07",
"TCGA-BH-A0BM-01A-11R-A056-07", "TCGA-BH-A1F8-01A-11R-A13Q-07",
"TCGA-E9-A1RI-01A-11R-A169-07", "TCGA-BH-A1F6-01A-11R-A13Q-07",
"TCGA-E9-A1N6-01A-11R-A144-07", "TCGA-A7-A0CH-01A-21R-A00Z-07",
"TCGA-BH-A0H7-01A-13R-A056-07", "TCGA-BH-A18U-01A-21R-A12D-07",
"TCGA-BH-A18U-01A-21R-A12D-07", "TCGA-E2-A1BC-01A-11R-A12P-07",
"TCGA-BH-A1FN-01A-11R-A13Q-07", "TCGA-BH-A1FM-01A-11R-A13Q-07",
"TCGA-E2-A15M-01A-11R-A12D-07", "TCGA-BH-A0DH-01A-11R-A084-07",
"TCGA-BH-A0AU-01A-11R-A12P-07", "TCGA-E9-A1RD-01A-11R-A157-07",
"TCGA-BH-A0C0-01A-21R-A056-07", "TCGA-BH-A0HA-01A-11R-A12P-07",
"TCGA-BH-A0BZ-01A-31R-A12P-07", "TCGA-BH-A0BW-01A-11R-A115-07",
"TCGA-BH-A1EN-01A-11R-A13Q-07", "TCGA-BH-A1FB-01A-11R-A13Q-07",
"TCGA-E9-A1NF-01A-11R-A14D-07", "TCGA-BH-A0H9-01A-11R-A056-07",
"TCGA-BH-A0DP-01A-21R-A056-07", "TCGA-A7-A0DC-01A-11R-A00Z-07",
"TCGA-E2-A1LB-01A-11R-A144-07", "TCGA-E2-A15I-01A-21R-A137-07",
"TCGA-BH-A0BV-01A-11R-A00Z-07", "TCGA-BH-A18N-01A-11R-A12D-07",
"TCGA-E9-A1N4-01A-11R-A14M-07", "TCGA-BH-A0DQ-01A-11R-A084-07",
"TCGA-BH-A0BT-01A-11R-A12P-07", "TCGA-BH-A0B7-01A-12R-A115-07",
"TCGA-BH-A18K-01A-11R-A12D-07", "TCGA-A7-A0D9-01A-31R-A056-07",
"TCGA-E9-A1NG-01A-21R-A14M-07", "TCGA-BH-A0DO-01B-11R-A12D-07",
"TCGA-BH-A0B8-01A-21R-A056-07", "TCGA-BH-A1FG-01A-11R-A13Q-07",
"TCGA-BH-A18Q-01A-12R-A12D-07", "TCGA-E9-A1R7-01A-11R-A14M-07",
"TCGA-BH-A0DG-01A-21R-A12P-07", "TCGA-BH-A208-01A-11R-A157-07",
"TCGA-BH-A0DL-01A-11R-A115-07", "TCGA-BH-A0C3-01A-21R-A12P-07",
"TCGA-A7-A13E-01A-11R-A277-07", "TCGA-BH-A0E1-01A-11R-A056-07",
"TCGA-BH-A0B5-01A-11R-A12P-07", "TCGA-BH-A204-01A-11R-A157-07",
"TCGA-BH-A0AZ-01A-21R-A12P-07", "TCGA-E2-A15K-01A-11R-A12P-07",
"TCGA-BH-A1FH-01A-12R-A13Q-07", "TCGA-BH-A18P-01A-11R-A12D-07",
"TCGA-BH-A0BJ-01A-11R-A056-07", "TCGA-E2-A1LH-01A-11R-A14D-07",
"TCGA-E2-A153-01A-12R-A12D-07", "TCGA-BH-A18S-01A-11R-A12D-07",
"TCGA-BH-A1EO-01A-11R-A137-07", "TCGA-E9-A1RC-01A-11R-A157-07",
"TCGA-BH-A0DZ-01A-11R-A00Z-07", "TCGA-E2-A1LS-01A-12R-A157-07",
"TCGA-BH-A0DV-01A-21R-A12P-07")
)
View(query_TCGA_tumor)
View(query_TCGA_tumor[[1]][[1]])
#download
GDCdownload(query_TCGA_tumor)
brca_rna_tumor <- GDCprepare(query_TCGA_tumor, summarizedExperiment = TRUE)
brca_rna_tum <- assay(brca_rna_tumor, 'unstranded', rownames = TRUE)
gene_name <- as.data.frame(brca_rna_tumor@rowRanges@elementMetadata@listData[["gene_name"]])
colnames(gene_name)[1] <- "GeneID"
brca_rna_tum <- as.data.frame(brca_rna_tum)
brca_rna_tum <- cbind(gene_name, brca_rna_tum)
View(brca_rna_tum)
brca_rna_tum <- brca_rna_tum[!duplicated(brca_rna_tum$GeneID), ] %>% remove_rownames %>% column_to_rownames(var="GeneID")
View(brca_rna_tum)
save(brca_rna_tum, file = '~/model_data/TCGA/breast_cancer/brca_rna_tum.Rdata')
query_TCGA_normal <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Transcriptome Profiling',
experimental.strategy = 'RNA-Seq',
workflow.type = 'STAR - Counts',
data.type = "Gene Expression Quantification",
access = 'open',
sample.type = "Solid Tissue Normal")
#BiocManager::install("TCGAbiolinks")
library(TCGAbiolinks)
library(tidyverse)
library(SummarizedExperiment)
query_TCGA_normal <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Transcriptome Profiling',
experimental.strategy = 'RNA-Seq',
workflow.type = 'STAR - Counts',
data.type = "Gene Expression Quantification",
access = 'open',
sample.type = "Solid Tissue Normal")
View(query_TCGA_normal)
View(query_TCGA_normal[[1]][[1]])
query_TCGA_cnv <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Copy Number Variation',
sample.type = "Primary Tumor",
data.type = "Gene Level Copy Number",
workflow.type = 'ASCAT3')
query_TCGA_cnv <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Copy Number Variation',
#sample.type = "Primary Tumor",
data.type = "Gene Level Copy Number",
workflow.type = 'ASCAT3')
View(query_TCGA_cnv)
View(query_TCGA_cnv[[1]][[1]])
brca_cnv_list <- c("TCGA-E9-A1RH-01A-21D-A166-01", "TCGA-BH-A1ET-01A-11D-A134-01",
"TCGA-BH-A0HK-01A-11D-A059-01", "TCGA-BH-A0H5-01A-21D-A111-01",
"TCGA-AC-A2FM-01A-11D-A19X-01", "TCGA-BH-A0DK-01A-21D-A059-01",
"TCGA-BH-A1FC-01A-11D-A13J-01", "TCGA-E9-A1N9-01A-11D-A14F-01",
"TCGA-GI-A2C8-01A-11D-A16C-01", "TCGA-BH-A18L-01A-32D-A12A-01",
"TCGA-BH-A0BS-01A-11D-A12N-01", "TCGA-BH-A0BQ-01A-21D-A111-01",
"TCGA-BH-A209-01A-11D-A160-01", "TCGA-BH-A1EV-01A-11D-A134-01",
"TCGA-BH-A1FR-01A-11D-A13J-01", "TCGA-BH-A0BC-01A-22D-A087-01",
"TCGA-BH-A0BA-01A-11D-A059-01", "TCGA-BH-A18J-01A-11D-A12A-01",
"TCGA-BH-A203-01A-12D-A166-01", "TCGA-BH-A18M-01A-11D-A12A-01",
"TCGA-BH-A1FJ-01A-11D-A13J-01", "TCGA-BH-A18R-01A-11D-A12A-01",
"TCGA-E9-A1ND-01A-11D-A141-01", "TCGA-A7-A0DB-01A-11D-A011-01",
"TCGA-E2-A158-01A-11D-A12A-01", "TCGA-BH-A1FU-01A-11D-A14F-01",
"TCGA-E9-A1RF-01A-11D-A160-01", "TCGA-E9-A1N5-01A-11D-A14F-01",
"TCGA-E2-A1L7-01A-11D-A141-01", "TCGA-E2-A1IG-01A-11D-A141-01",
"TCGA-AC-A2FF-01A-11D-A17C-01", "TCGA-BH-A1FE-01A-11D-A13J-01",
"TCGA-BH-A0DT-01A-21D-A12A-01", "TCGA-A7-A0CE-01A-11D-A011-01",
"TCGA-BH-A1F2-01A-31D-A13J-01", "TCGA-A7-A13G-01A-11D-A13J-01",
"TCGA-BH-A18V-01A-11D-A12A-01", "TCGA-AC-A2FB-01A-11D-A17C-01",
"TCGA-A7-A13F-01A-11D-A12N-01", "TCGA-BH-A0E0-01A-11D-A059-01",
"TCGA-BH-A1F0-01A-11D-A134-01", "TCGA-BH-A0B3-01A-11D-A059-01",
"TCGA-BH-A1EU-01A-11D-A134-01", "TCGA-BH-A0DD-01A-31D-A12N-01",
"TCGA-AC-A23H-01A-11D-A160-01", "TCGA-BH-A0AY-01A-21D-A011-01",
"TCGA-E9-A1RB-01A-11D-A160-01", "TCGA-E9-A1NA-01A-11D-A141-01",
"TCGA-BH-A1FD-01A-11D-A13J-01", "TCGA-BH-A0BM-01A-11D-A059-01",
"TCGA-BH-A1F8-01A-11D-A13J-01", "TCGA-E9-A1RI-01A-11D-A166-01",
"TCGA-BH-A1F6-01A-11D-A13J-01", "TCGA-E9-A1N6-01A-11D-A141-01",
"TCGA-A7-A0CH-01A-21D-A011-01", "TCGA-BH-A0H7-01A-13D-A059-01",
"TCGA-BH-A18U-01A-21D-A12A-01", "TCGA-GI-A2C9-01A-11D-A21P-01",
"TCGA-E2-A1BC-01A-11D-A12N-01", "TCGA-BH-A1FN-01A-11D-A13J-01",
"TCGA-BH-A1FM-01A-11D-A13J-01", "TCGA-E2-A15M-01A-11D-A12A-01",
"TCGA-BH-A0DH-01A-11D-A087-01", "TCGA-BH-A0AU-01A-11D-A12N-01",
"TCGA-E9-A1RD-01A-11D-A160-01", "TCGA-BH-A0C0-01A-21D-A059-01",
"TCGA-BH-A0HA-01A-11D-A12N-01", "TCGA-BH-A0BZ-01A-31D-A12N-01",
"TCGA-BH-A0BW-01A-11D-A111-01", "TCGA-BH-A1EN-01A-11D-A13J-01",
"TCGA-BH-A1FB-01A-11D-A13J-01", "TCGA-E9-A1NF-01A-11D-A14F-01",
"TCGA-BH-A0H9-01A-11D-A059-01", "TCGA-BH-A0DP-01A-21D-A059-01",
"TCGA-A7-A0DC-01A-11D-A011-01", "TCGA-E2-A1LB-01A-11D-A141-01",
"TCGA-E2-A15I-01A-21D-A134-01", "TCGA-BH-A0BV-01A-11D-A011-01",
"TCGA-BH-A18N-01A-11D-A12A-01", "TCGA-E9-A1N4-01A-11D-A14J-01",
"TCGA-BH-A0DQ-01A-11D-A087-01", "TCGA-BH-A0BT-01A-11D-A12N-01",
"TCGA-BH-A0B7-01A-12D-A111-01", "TCGA-BH-A18K-01A-11D-A12A-01",
"TCGA-A7-A0D9-01A-31D-A059-01", "TCGA-E9-A1NG-01A-21D-A14J-01",
"TCGA-BH-A0DO-01B-11D-A12A-01", "TCGA-BH-A0B8-01A-21D-A059-01",
"TCGA-BH-A1FG-01A-11D-A13J-01", "TCGA-BH-A18Q-01A-12D-A12A-01",
"TCGA-E9-A1R7-01A-11D-A14J-01", "TCGA-BH-A0DG-01A-21D-A12N-01",
"TCGA-BH-A208-01A-11D-A160-01", "TCGA-BH-A0DL-01A-11D-A111-01",
"TCGA-BH-A0C3-01A-21D-A12N-01", "TCGA-A7-A13E-01A-11D-A12N-01",
"TCGA-BH-A0E1-01A-11D-A059-01", "TCGA-BH-A0B5-01A-11D-A12N-01",
"TCGA-BH-A204-01A-11D-A160-01", "TCGA-BH-A0AZ-01A-21D-A12N-01",
"TCGA-E2-A15K-01A-11D-A12N-01", "TCGA-BH-A1FH-01A-12D-A13J-01",
"TCGA-BH-A0BJ-01A-11D-A059-01", "TCGA-E2-A1LH-01A-11D-A14F-01",
"TCGA-E2-A153-01A-12D-A12A-01", "TCGA-BH-A18S-01A-11D-A12A-01",
"TCGA-BH-A1EO-01A-11D-A134-01", "TCGA-E9-A1RC-01A-11D-A160-01",
"TCGA-BH-A0DZ-01A-11D-A011-01", "TCGA-BH-A0DV-01A-21D-A12N-01")
query_TCGA_cnv <- GDCquery(project = 'TCGA-BRCA',
data.category = 'Copy Number Variation',
#sample.type = "Primary Tumor",
data.type = "Gene Level Copy Number",
workflow.type = 'ASCAT3',
barcode = brca_cnv_list)
##build a query to retrieve data
getResults(query_TCGA_cnv)
#download
GDCdownload(query_TCGA_cnv)
#prepare data
brca_cnv <- GDCprepare(query_TCGA_cnv, summarizedExperiment = TRUE)
brca_cnv_tumor <- assay(brca_cnv, 'copy_number', rownames = TRUE)
View(brca_cnv_tumor)
View(brca_cnv_tumor)
gene_name <- as.data.frame(brca_cnv@rowRanges@elementMetadata@listData[["gene_name"]])
View(gene_name)
View(brca_cnv)
colnames(gene_name)[1] <- "GeneID"
brca_cnv_tumor <- as.data.frame(brca_cnv_tumor)
View(brca_cnv_tumor)
brca_cnv_tumor <- cbind(gene_name, brca_cnv_tumor)
brca_cnv_tumor <- brca_cnv_tumor[!duplicated(brca_cnv_tumor$GeneID), ] %>% remove_rownames %>% column_to_rownames(var="GeneID")
View(brca_cnv_tumor)
brca_cnv_tumor <- na.omit(brca_cnv_tumor)
View(brca_cnv_tumor)
save(brca_cnv_tumor, file = '~/model_data/TCGA/breast_cancer/brca_cnv_tumor.Rdata')
library(limma)
library(DESeq2)
library(cowplot)
library(proDA)
library(limma)
library(DESeq2)
library(cowplot)
#library(proDA)
library(pheatmap)
library(SummarizedExperiment)
library(tidyverse)
#load datasets
load("../data/patMeta_enc.RData")
load("../data/ddsrna_enc.RData")
load("../data/proteomic_explore_enc.RData")
source("../code/utils.R")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, dev = c("png","pdf"))
View(patMeta)
View(sampleTab)
pathInfo <- sampleTab %>% filter(!lowQuality, !duplicatedPat)
View(pathInfo)
View(sampleTab)
labelBatch <- c(batch1 = "batch1", batch2 = "batch3", batch3 = "batch2")
patInfo <- sampleTab %>% filter(!lowQuality, !duplicatedPat)
patInfo <- patInfo %>% select(encID, leukCount, cohort,batch)
patInfo <- patInfo %>% select(encID, leukCount, cohort,batch) %>%
mutate(batch = labelBatch[batch])
View(patInfo)
patInfo <- patInfo %>% select(encID, leukCount, cohort,batch) %>%
mutate(batch = labelBatch[batch]) %>%
arrange(batch, encID)
View(patInfo)
View(sampleTab)
View(sampleTab)
View(patMeta)
View(patInfo)
View(sampleTab)
View(patMeta)
patInfo <- patInfo %>% select(encID, leukCount, cohort,batch) %>%
mutate(batch = labelBatch[batch]) %>%
arrange(batch, encID) %>%
left_join(select(patMeta, Patient.ID, IGHV.status, trisomy12), by = c(encID = "Patient.ID"))
View(patInfo)
patInfo <- patInfo %>% select(encID, leukCount, cohort,batch) %>%
mutate(batch = labelBatch[batch]) %>%
arrange(batch, encID) %>%
left_join(select(patMeta, Patient.ID, IGHV.status, trisomy12), by = c(encID = "Patient.ID")) %>%
left_join(select(survT, patID, OS, died, TTT, treatedAfter, TTT, age, sex, pretreat), by = c(encID = "patID"))
View(patInfo)
patInfo <- patInfo %>% select(encID, leukCount, cohort,batch) %>%
mutate(batch = labelBatch[batch]) %>%
arrange(batch, encID) %>%
left_join(select(patMeta, Patient.ID, IGHV.status, trisomy12), by = c(encID = "Patient.ID")) %>%
left_join(select(survT, patID, OS, died, TTT, treatedAfter, TTT, age, sex, pretreat), by = c(encID = "patID")) %>%
mutate(`No.` = seq(nrow(.)))
View(patInfo)
View(patInfo)
geneMat <- patMeta[match(patInfo$encID, patMeta$Patient.ID)]
geneMat <- patMeta[match(patInfo$encID, patMeta$Patient.ID),]
View(geneMat)
geneMat <- patMeta[match(patInfo$encID, patMeta$Patient.ID),] %>%
select(-Methylation_Cluster)
View(geneMat)
mutate(IGHV.status = ifelse(!is.na(IGHV.status), ifelse(IGHV.status == "M",1,0),NA)
View(geneMat)
View(geneMat)
View(sampleTab)
mutate(cohort = sampleTab[match(Patient.ID, sampleTab$encID),]$cohort)
geneMat <-  patMeta[match(patInfo$encID, patMeta$Patient.ID),] %>%
select(-Methylation_Cluster) %>%
mutate(IGHV.status = ifelse(!is.na(IGHV.status), ifelse(IGHV.status == "M",1,0),NA)) %>%
mutate(cohort = sampleTab[match(Patient.ID, sampleTab$encID),]$cohort) %>%
mutate(cohort = ifelse(cohort == "exploration",1,0)) %>%
mutate_if(is.factor, as.character) %>%
mutate_at(vars(-Patient.ID), as.numeric) %>% #assign a few unknown mutated cases to wildtype
data.frame() %>% column_to_rownames("Patient.ID")
View(geneMat)
View(geneMat)
geneMat <- geneMat[,apply(geneMat,2, function(x) sum(x %in% 1, na.rm = TRUE))>=5]
geneMat <-  patMeta[match(patInfo$encID, patMeta$Patient.ID),] %>%
select(-Methylation_Cluster) %>%
mutate(IGHV.status = ifelse(!is.na(IGHV.status), ifelse(IGHV.status == "M",1,0),NA)) %>%
mutate(cohort = sampleTab[match(Patient.ID, sampleTab$encID),]$cohort) %>%
mutate(cohort = ifelse(cohort == "exploration",1,0)) %>%
mutate_if(is.factor, as.character) %>%
mutate_at(vars(-Patient.ID), as.numeric) %>% #assign a few unknown mutated cases to wildtype
data.frame() %>% column_to_rownames("Patient.ID")
View(geneMat)
geneMat <- geneMat[,apply(geneMat,2, function(x) sum(x %in% 1, na.rm = TRUE))>=5]
View(geneMat)
#protCLL <- protCLL[,colnames(protCLL) %in% patMeta$Patient.ID]
library(limma)
library(DESeq2)
library(qvalue)
library(proDA)
library(limma)
library(DESeq2)
library(qvalue)
#library(proDA)
library(IHW)
library(limma)
library(DESeq2)
library(qvalue)
#library(proDA)
#library(IHW)
library(SummarizedExperiment)
library(tidyverse)
#load datasets
load("../data/patMeta_enc.RData")
load("../data/ddsrna_enc.RData")
load("../data/proteomic_explore_enc.RData")
source("../code/utils.R")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,dev = c("png","pdf"))
#protCLL <- protCLL[,colnames(protCLL) %in% patMeta$Patient.ID]
View(dds)
#protCLL <- protCLL[rowData(protCLL)$uniqueMap,]
protMat <- assays(protCLL)[["count"]] #without imputation
protMatLog <- assays(protCLL)[["log2Norm"]]
View(protMat)
